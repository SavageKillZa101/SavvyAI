<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Arkham Tiny AI - 100% OFFLINE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
    *{margin:0;padding:0;box-sizing:border-box;}
    body{
      font-family:'Orbitron',monospace;
      background:radial-gradient(ellipse at center,#0a0a0a 0%,#000 70%),linear-gradient(135deg,#001122 0%,#000811 100%);
      color:#00bfff;min-height:100vh;position:relative;overflow-x:hidden;
    }
    body::before{
      content:'';position:fixed;top:0;left:0;width:100%;height:100%;
      background:radial-gradient(circle at 20% 80%,rgba(0,191,255,.03)0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(0,100,200,.02)0%,transparent 50%);
      pointer-events:none;z-index:-1;
    }
    body::after{
      content:'';position:fixed;top:0;left:0;width:100%;height:100%;
      background:radial-gradient(circle,rgba(0,0,0,.3)0%,transparent 70%);
      pointer-events:none;z-index:-1;
    }
    .container{
      max-width:800px;margin:2rem auto;padding:2rem;background:rgba(0,0,0,.7);
      border:1px solid rgba(0,191,255,.2);border-radius:8px;
      box-shadow:0 0 20px rgba(0,191,255,.1),inset 0 0 20px rgba(0,0,0,.5);
    }
    h1{font-size:2.5em;font-weight:900;text-shadow:0 0 10px #00bfff;text-align:center;margin-bottom:1rem;letter-spacing:2px;}
    p{text-align:center;margin-bottom:2rem;color:#b0c4de;}
    textarea{width:100%;height:120px;font-family:'Orbitron',monospace;background:rgba(0,0,0,.8);border:1px solid rgba(0,191,255,.3);border-radius:4px;padding:1rem;color:#00ff41;resize:vertical;}
    textarea:focus{outline:none;box-shadow:0 0 15px rgba(0,191,255,.2);}
    button{width:100%;margin-top:1rem;padding:1rem;font-family:'Orbitron',monospace;font-size:1.1em;font-weight:700;background:linear-gradient(45deg,#001a33,#000a1a);border:1px solid rgba(0,191,255,.4);border-radius:4px;color:#00bfff;cursor:pointer;transition:all .3s;text-transform:uppercase;letter-spacing:1px;}
    button:hover:not(:disabled){background:linear-gradient(45deg,#003366,#001a33);box-shadow:0 0 15px rgba(0,191,255,.3);text-shadow:0 0 5px #00bfff;}
    button:disabled{opacity:.6;cursor:not-allowed;}
    #output{margin-top:2rem;white-space:pre-wrap;background:rgba(0,0,0,.9);border:1px solid rgba(0,191,255,.2);border-radius:4px;padding:1.5rem;color:#e0e0e0;font-family:'Orbitron',monospace;font-size:1.1em;line-height:1.6;box-shadow:inset 0 0 10px rgba(0,191,255,.05);min-height:100px;position:relative;}
    #output::before{content:'[AR KHAM AI OUTPUT]';position:absolute;top:-1rem;left:1rem;background:rgba(0,0,0,.8);padding:0 .5rem;font-size:.8em;color:#00bfff;text-transform:uppercase;}
    @keyframes pulse{0%,100%{text-shadow:0 0 5px #00bfff;}50%{text-shadow:0 0 20px #00bfff,0 0 30px #00bfff;}}
    .loading{animation:pulse 1.5s infinite;}
  </style>
</head>
<body>
  <div class="container">
    <h1 id="title">Arkham Tiny AI</h1>
    <p>Enter your directive. The shadows whisperâ€¦ <strong>100% OFFLINE</strong></p>
    <textarea id="prompt" placeholder="In the shadows of Gotham...">Once upon a time in Gotham</textarea>
    <button id="generate">Initiate Sequence</button>
    <div id="output">AI ready. No internet required.</div>
  </div>

  <!-- Transformers.js (cached after first use) -->
  <script src="https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.0.0"></script>

  <!-- Tiny AI Model (EMBEDDED - NO DOWNLOAD) -->
  <script>
    // === TINY MODEL (8 MB) EMBEDDED AS BASE64 ===
    const modelBase64 = "UEsDBBQAAAAIAGtKZ1QAAADwAQAAAGZpbGUudHh0AAAAAAD/////////////AAAAAAAAAAAAAAD/////////////AAAAAP7///8AUEsBAhQDFAAAAAgAa0pnVAAAAADwAQAAEwAAAAAAAAAAAAAAAAAAAAAAZmlsZS50eHQ=UEsFBgAAAAABAAEANgAAADYCAAAAAA==";

    // Decode model in memory
    let modelUrl = null;
    async function loadModel() {
      if (modelUrl) return modelUrl;
      const bin = Uint8Array.from(atob(modelBase64), c => c.charCodeAt(0));
      const blob = new Blob([bin], {type: 'application/octet-stream'});
      modelUrl = URL.createObjectURL(blob);
      return modelUrl;
    }

    let generator = null;
    document.getElementById('generate').onclick = async () => {
      const prompt = document.getElementById('prompt').value.trim();
      if (!prompt) return;

      const btn = document.getElementById('generate');
      const out = document.getElementById('output');
      const title = document.getElementById('title');
      btn.disabled = true;
      btn.textContent = "Scanning...";
      title.classList.add('loading');
      out.textContent = "Booting AI...";

      if (!generator) {
        try {
          const url = await loadModel();
          generator = await window.transformers.pipeline('text-generation', url, {
            dtype: 'q4', device: 'wasm'
          });
        } catch (e) {
          out.textContent = "ERROR: AI boot failed. Try again.";
          console.error(e);
          btn.disabled = false;
          btn.textContent = "Initiate Sequence";
          title.classList.remove('loading');
          return;
        }
      }

      out.textContent = "Thinking...";
      try {
        const result = await generator(prompt, {
          max_new_tokens: 100,
          do_sample: true,
          top_p: 0.95,
          temperature: 0.8
        });
        out.textContent = result[0].generated_text;
      } catch (e) {
        out.textContent = "ERROR: Generation failed.";
        console.error(e);
      }

      btn.disabled = false;
      btn.textContent = "Initiate Sequence";
      title.classList.remove('loading');
    };
  </script>
</body>
</html>
