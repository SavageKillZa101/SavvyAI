<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Arkham Tiny AI (Local Unrestricted)</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap'); /* Holographic font */

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Orbitron', monospace;
      background: radial-gradient(ellipse at center, #0a0a0a 0%, #000 70%), 
                  linear-gradient(135deg, #001122 0%, #000811 100%); /* Gotham night sky with navy depth */
      color: #00bfff; /* Cyan glow */
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, rgba(0, 191, 255, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(0, 100, 200, 0.02) 0%, transparent 50%); /* Subtle scan lights */
      pointer-events: none;
      z-index: -1;
    }

    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(0,0,0,0.3) 0%, transparent 70%); /* Vignette for focus */
      pointer-events: none;
      z-index: -1;
    }

    .container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 2rem;
      position: relative;
      z-index: 1;
      background: rgba(0, 0, 0, 0.7);
      border: 1px solid rgba(0, 191, 255, 0.2);
      border-radius: 8px;
      box-shadow: 
        0 0 20px rgba(0, 191, 255, 0.1),
        inset 0 0 20px rgba(0, 0, 0, 0.5); /* Holographic glow + depth */
    }

    h1 {
      text-align: center;
      font-size: 2.5em;
      font-weight: 900;
      text-shadow: 0 0 10px #00bfff;
      margin-bottom: 1rem;
      letter-spacing: 2px;
      color: #00bfff;
    }

    p {
      text-align: center;
      font-size: 1.1em;
      margin-bottom: 2rem;
      opacity: 0.9;
      color: #b0c4de; /* Light steel blue text */
    }

    textarea {
      width: 100%;
      height: 120px;
      font-family: 'Orbitron', monospace;
      font-size: 1em;
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid rgba(0, 191, 255, 0.3);
      border-radius: 4px;
      padding: 1rem;
      color: #00ff41; /* Green terminal glow for input */
      resize: vertical;
      box-shadow: 0 0 10px rgba(0, 191, 255, 0.05);
      transition: box-shadow 0.3s ease;
    }

    textarea:focus {
      outline: none;
      box-shadow: 0 0 15px rgba(0, 191, 255, 0.2);
    }

    textarea::placeholder {
      color: rgba(176, 196, 222, 0.5);
    }

    button {
      width: 100%;
      margin-top: 1rem;
      padding: 1rem;
      font-family: 'Orbitron', monospace;
      font-size: 1.1em;
      font-weight: 700;
      background: linear-gradient(45deg, #001a33, #000a1a); /* Dark blue gradient */
      border: 1px solid rgba(0, 191, 255, 0.4);
      border-radius: 4px;
      color: #00bfff;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    button:hover:not(:disabled) {
      background: linear-gradient(45deg, #003366, #001a33);
      box-shadow: 0 0 15px rgba(0, 191, 255, 0.3);
      text-shadow: 0 0 5px #00bfff;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    #output {
      margin-top: 2rem;
      white-space: pre-wrap;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(0, 191, 255, 0.2);
      border-radius: 4px;
      padding: 1.5rem;
      color: #e0e0e0;
      font-family: 'Orbitron', monospace;
      font-size: 1.1em;
      line-height: 1.6;
      box-shadow: inset 0 0 10px rgba(0, 191, 255, 0.05);
      min-height: 100px;
      position: relative;
    }

    #output::before {
      content: '[AR KHAM AI OUTPUT]';
      position: absolute;
      top: -1rem;
      left: 1rem;
      background: rgba(0, 0, 0, 0.8);
      padding: 0 0.5rem;
      font-size: 0.8em;
      color: #00bfff;
      text-transform: uppercase;
    }

    /* Pulse animation for loading */
    @keyframes pulse-glow {
      0%, 100% { text-shadow: 0 0 5px #00bfff; }
      50% { text-shadow: 0 0 20px #00bfff, 0 0 30px #00bfff; }
    }

    .loading {
      animation: pulse-glow 1.5s infinite;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="title" class="loading">Arkham Tiny AI</h1>
    <p>Enter your directive. The shadows whisper... Works offline on any device.</p>

    <textarea id="prompt" placeholder="In the shadows of Gotham, the Bat-Signal flickers...">Once upon a time in Gotham</textarea><br>
    <button id="generate">Initiate Sequence</button>

    <div id="output"></div>
  </div>

  <!-- Transformers.js + pre-converted model -->
  <script src="https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.0.0"></script>
  <script>
    const modelUrl = "https://huggingface.co/roneneldan/TinyStories-1M/resolve/main/transformers_js/model.onnx";

    let generator = null;
    const btn = document.getElementById('generate');
    const out = document.getElementById('output');
    const promptEl = document.getElementById('prompt');
    const title = document.getElementById('title');

    btn.addEventListener('click', async () => {
      const prompt = promptEl.value.trim();
      if (!prompt) return;

      btn.disabled = true;
      btn.textContent = 'Scanning...';
      title.classList.add('loading');
      out.textContent = 'Acquiring neural net (initial boot)...';

      if (!generator) {
        try {
          generator = await window.transformers.pipeline('text-generation', modelUrl, {
            dtype: 'q4',          // 4-bit quantized â†’ ~8 MB
            device: 'wasm'        // runs on CPU via WebAssembly
          });
        } catch (e) {
          out.textContent = 'Error: Failed to load shadows. Check connection.';
          console.error(e);
          btn.disabled = false;
          btn.textContent = 'Initiate Sequence';
          title.classList.remove('loading');
          return;
        }
      }

      out.textContent = 'Decrypting response...';
      const result = await generator(prompt, {
        max_new_tokens: 100,
        do_sample: true,
        top_p: 0.95,
        temperature: 0.8,
      });

      out.textContent = result[0].generated_text;
      btn.disabled = false;
      btn.textContent = 'Initiate Sequence';
      title.classList.remove('loading');
    });
  </script>
</body>
</html>
